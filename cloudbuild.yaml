steps:
- name: node:16.17.1
  entrypoint: npm
  args: ["install"]
- name: node:16.17.1
  entrypoint: npm
  args: ["run", "create-env"]
  env:
    - 'DATABASE_URL=${_DATABASE_URL}'
    - 'JWT_SECRET=${_JWT_SECRET}'
    - 'AWS_BUCKET_NAME=${_AWS_BUCKET_NAME}'
    - 'AWS_BUCKET_REGION=${_AWS_BUCKET_REGION}'
    - 'AWS_ACCESS_KEY=${_AWS_ACCESS_KEY}'
    - 'AWS_SECRET_KEY=${_AWS_SECRET_KEY}'
- name: "gcr.io/cloud-builders/gcloud"
  args: ["app", "deploy", "app.yaml"]
timeout: "1600s"
